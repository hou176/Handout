# 复习

- 浏览器的同源策略
    - 同源：协议、域名、端口号
    - 浏览会截断正常的请求，改用options请求进行试探
- 实现js的跨域
    - 前端http://127.0.0.1:8080
    - 后端http://127.0.0.1:8000
    - 方案：在服务端响应options请求，在响应报文头中包含：Control-Access-****
    - 实现：cores===》注册，中间件，白名单
- jwt
    - 三部分：header、payload、signature
    - 验证：根据请求中的header、payload计算一个signature1，从请求报文中取出signature，对比，如果相同则有效，如果不相同则无效
- drf-jwt
    - 登录
    - 自定义响应体
    - 自定义载荷
    - 自定义登录验证

# 反馈

- ***	只是点有什么速记技巧么 还是说只有，记，记，记呢
    - 记，没有技巧
    - 多重复
    - 结合实际问题多运用
- ***	好！ 很好！ 非常好！！！
- ***	好，很好，非常好，yes I can
- 白名单配置
    - http://127.0.0.1:8080
    - s====>需要安全证书

# 今天知识点

- 数据统计
- 用户管理
- 规格管理

# 数据统计

- 模型类.objects.filter().count()

# 用户管理

### 查询

- ListModelMixin
- ModelSerializer
- 分页：继承自drf的分页类
    - 重写响应方法，返回前端需要的格式
    - 指定分页参数
    - 说明：drf的分页使用django的分页模块
- 过滤
- 选择queryset属性还是get_queryset()方法
    - 默认使用属性queryset
    - 如果需要从请求报文中获取数据，拼接条件，则使用方法

### 增加

- CreateModelMixin
- 自定义序列化器，重写create()方法
- 普通创建：模型类.objects.create()
- 用户创建：User.objects.create_user()
- 关键：密码加密

# 规格管理

- 视图：ModelViewSet
- 序列化器：ModelSerializer
- 查询所有SPU
    - ListAPIView
    - ModelSerializer
- 代码没错，但是一直提示4**错误
    - F12打开开发者工具
    - 点击network标签
    - 勾选“disable cache”
    - 刷新页面

# 总结

### 重要知识点

- 视图类：
    - ListCreateAPIView
    - ListAPIView
    - ModelViewSet
- 序列化器类：
    - Serializer
    - ModelSerializer
- 说明：用户创建，重写create()方法
    - 因为：密码加密再保存

### 作业

- 完成今天代码

### 大纲要求

- 能够理解用户总数统计的代码逻辑

```
模型类.objects.filter(***).count()
```

- 能够知道改写分页返回结果的方法

```
1.自定义类，继承自drf的PageNumberPaginator
2.重写方法get_paginated_response()
3.返回指定的字典结构
说明：drf的分页实现，使用了django的分页类型Paginator、Page
```

- 在保存用户功能中，能够知道改写序列化器中create方法的原因

```
默认实现：模型类.objects.create(**dict)
将接收到的数据保存到表中
重写：密码需要加密再保存
方法实现：User.objects.create_user(**dict)
```
