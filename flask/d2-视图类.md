# 复习

- RESTful规范
    - 路径：名词复数
    - 请求方式：get,post,put,delete
    - 返回值
    - 状态码:200,201,204
- 序列化
    - 将对象转换成字典
    - 实现：1.定义类，根据模型类定义属性；2.创建实例，模型类对象作为参数；3.调用属性data
    - 关系属性序列化：主键，字符串，自定义序列器
    - 参数many=True
    - 使用场景：查询多条，查询一条，创建，修改
- 反序列化--验证
    - 将请求报文中的字典转换成实例
    - 验证，保存
    - 验证方式：
        - 类型
        - 约束
        - 自定义方法
    - 实现：1.定义类；2.创建实例，以请求字典为参数；3.方法is_valid()；4.判断，属性validated_data，属性errors
    - 使用场景：创建，修改

# 今天知识点

- 反序列化-保存
- 模型类序列化器
- Request对象
- Response对象
- APIView
- GenericAPIView+5个ModelMixin

# 反序列化-保存

- 保存
    - 创建===》create
    - 修改===》update
- 创建调用
    - 1.创建序列化器对象，为data参数赋值
    - 2.调用is_valid()验证数据是否合法
    - 3.调用save()方法完成创建，这个方法内部会调用create()方法
- 修改调用
    - 1.创建序列化器对象，为instance、data参数赋值
    - 2.调用is_valid()验证数据是否合法
    - 3.调用save()方法完成修改，这个方法内部会进行判断，决定调用update()还是create()
- 创建序列化器对象时使用的参数
    - instance===>模型类对象
    - data======>请求报文中的json数据
    - 序列化：使用instance参数
    - 反序列化---创建：使用data参数
    - 反序列化---修改：都用
- 对比data与validated_data
    - data表示请求报文中的数据，类型都是字符串
    - validated_data表示验证后的数据，类型是转换后的类型

# 模型类序列化器

- 类型ModelSerializer，继承自Serializer，封装了新代码
    - 定义属性
    - create()方法
    - update()方法
- 需要自已实现的代码：验证方法
- 使用前提：模型类
- 原则：代码越少越好

# Request对象

- 继承自django的HttpRequest类
- 新增了两个属性
    - data===》用于接收表单、非表单数据
    - query_params===》用于接收查询参数

# Response对象

- 继承自django的HttpResponse类
- 新功能：
    - 直接返回json数据，字典，列表
    - 提供了辅助界面

# APIView

- 继承自django的View类，重写as_view()与dispatch()方法，在原基础上提供上新功能
    - 1.新的Request对象
    - 2.新的Response对象
    - 3.统一的异常处理
    - 4.验证、检查、限流

# GenericAPIView+5个ModelMixin

- 5个ModelMxin类
    - list======>查询多条
    - create====>创建
    - retrieve==>查询一条
    - update====>修改
    - destroy===>删除
- GenericAPIView类
    - 继承自APIView
    - 新属性queryset===》指定查询集
    - 新属性serializer_class===》指定序列化器类型
    - 新方法get_queryset()===>指定查询集，默认使用属性
    - 新方法get_serializer_class()===>指定序列化器类型，默认使用属性
    - 新方法get_serializer()=====>创建序列化器类型的对象
    - 新方法get_object()=====>在查询集上拼接get()方法，根据主键查询对象

# 总结

### 重要知识点

- 反序列化保存
    - 在序列化器类中定义方法：create(),update()
    - 调用：serializer.save()
    - 创建：serializer=Serializer(data=***)
    - 修改：serializer=Serializer(对象,data=***)
- ModelSerializer====>将序列化器中的属性定义、create()、update()封装
- APIView
    - 继承自django的View
    - 1.新的request
    - 2.新的response
    - 3.统一异常处理
    - 4.验证
    - 所有代码都需要自己实现
- GenericAPIView+5个ModelMixin
    - 组合
    - 属性queryset
    - 属性serializer_class

### 作业

- 完成今天代码:APIView，反序列化器保存
- 背单词

操作 | 单词
---|---
查询多条 | list
创建 | create
查询一个 | retrieve
修改 | update
删除 | destroy

### 大纲要求

- 能够使用序列化器校验数据

```
验证的方式：
    1.类型
    2.约束
    3.自定义方法
调用：serializer.is_valid()
```

- 能够使用序列化器保存校验后的数据

```
serializer.save()
在序列化器类中定义create()、update()方法
```

- 能够使用GenericAPIView获取图书信息

```
ListAPIView
指定查询集、序列化器
```
